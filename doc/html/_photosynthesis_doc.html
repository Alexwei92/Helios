<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>.: Photosynthesis Model Plugin Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Helios_logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">.
   &#160;<span id="projectnumber">v1.0.16</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="_plug_ins.html">Plug-ins</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Photosynthesis Model Plugin Documentation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#PhotoConstructor">Class Constructor</a></li>
<li class="level1"><a href="#VarsAndProps">Primitive Data</a><ul><li class="level2"><a href="#PhotoInputData">Input Primitive Data</a></li>
<li class="level2"><a href="#PhotoOutputData">Output Primitive Data</a></li>
</ul>
</li>
<li class="level1"><a href="#PhotoDescription">Introduction</a></li>
<li class="level1"><a href="#EmpiricalDescription">Empirical Model Description</a><ul><li class="level2"><a href="#LightResponse">Light Response Function</a></li>
<li class="level2"><a href="#TempResponse">Temperature Response</a></li>
<li class="level2"><a href="#CO2Response">CO2 Response Function</a></li>
<li class="level2"><a href="#Ci">Intercellular CO2 Concentration</a></li>
<li class="level2"><a href="#PhotoCalib">Empirical Model Calibration Procedure</a><ul><li class="level3"><a href="#PhotoVars">Summary of Empirical Model Independent Variables</a></li>
<li class="level3"><a href="#PhotoParams">Summary of Empirical Model Parameters</a></li>
<li class="level3"><a href="#PhotoLightParam">Response of Assimilation Rate to Light</a></li>
<li class="level3"><a href="#PhotoTempParam">Response of Assimilation Rate to Temperature</a></li>
<li class="level3"><a href="#PhotoRespParam">Response of Respiration Rate to Temperature</a></li>
<li class="level3"><a href="#PhotoCO2Param">Response of Assimilation Rate to CO2</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#FarquharDescription">Farquhar, von Caemmerer, Berry Model Description</a><ul><ul><li class="level3"><a href="#FvCBPhotoVars">Summary of FvCB Model Independent Variables</a></li>
<li class="level3"><a href="#FvCBPhotoParams">Summary of FvCB Model Parameters</a></li>
</ul>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><br />
<br />
 </p>
<table class="doxtable">
<tr>
<th>Dependencies </th><td>None  </td></tr>
<tr>
<th>CMakeLists.txt </th><td>set( PLUGINS "photosynthesis" )  </td></tr>
<tr>
<th>Header File </th><td>#include "PhotosynthesisModel.h"  </td></tr>
<tr>
<th>Class </th><td><a class="el" href="class_photosynthesis_model.html">PhotosynthesisModel</a>  </td></tr>
</table>
<h1><a class="anchor" id="PhotoConstructor"></a>
Class Constructor</h1>
<table class="doxtable">
<tr>
<th>Constructors  </th></tr>
<tr>
<td><a class="el" href="class_photosynthesis_model.html">PhotosynthesisModel( helios::Context* )</a>  </td></tr>
</table>
<h1><a class="anchor" id="VarsAndProps"></a>
Primitive Data</h1>
<h2><a class="anchor" id="PhotoInputData"></a>
Input Primitive Data</h2>
<table class="doxtable">
<tr>
<th>Primitive Data Label </th><th>Symbol </th><th>Units </th><th>Data Type </th><th>Description </th><th>Available Plug-ins </th><th>Default Value  </th></tr>
<tr>
<td>radiation_flux_PAR </td><td><img class="formulaInl" alt="$i$" src="form_43.png"/> </td><td>W/m<sup>2</sup> </td><td> <font face="courier" color="green">float</font> </td><td>Radiative flux in PAR band. </td><td>Can be computed by <a class="el" href="class_radiation_model.html">RadiationModel</a> plug-in. </td><td>0  </td></tr>
<tr>
<td>temperature </td><td><img class="formulaInl" alt="$T_s$" src="form_7.png"/> </td><td>Kelvin </td><td> <font face="courier" color="green">float</font> </td><td>Primitive surface temperature. </td><td>Can be computed by <a class="el" href="class_energy_balance_model.html">EnergyBalanceModel</a> plug-in. </td><td>300 K  </td></tr>
<tr>
<td>air_CO2 </td><td><img class="formulaInl" alt="$C_a$" src="form_115.png"/> </td><td><img class="formulaInl" alt="$\mu$" src="form_24.png"/>mol CO<sub>2</sub>/mol air </td><td> <font face="courier" color="green">float</font> </td><td>CO<sub>2</sub> concentration of air outside of primitive boundary-layer. </td><td>N/A </td><td>390 <img class="formulaInl" alt="$\mu$" src="form_24.png"/>mol/mol  </td></tr>
<tr>
<td>moisture_conductance </td><td><img class="formulaInl" alt="$g_M$" src="form_10.png"/> </td><td>mol air/m<sup>2</sup>-s </td><td> <font face="courier" color="green">float</font> </td><td>Overall conductance to moisture between substomatal cells and outside of boundary-layer. </td><td>Can be computed by <a class="el" href="class_stomatal_conductance_model.html">StomatalConductanceModel</a> plug-in. </td><td>0.25 mol/m<sup>2</sup>-s  </td></tr>
</table>
<h2><a class="anchor" id="PhotoOutputData"></a>
Output Primitive Data</h2>
<table class="doxtable">
<tr>
<th>Primitive Data Label </th><th>Symbol </th><th>Units </th><th>Data Type </th><th>Description  </th></tr>
<tr>
<td>net_photosynthesis </td><td><img class="formulaInl" alt="$A$" src="form_42.png"/> </td><td><img class="formulaInl" alt="$\mu$" src="form_24.png"/>mol CO<sub>2</sub>/m<sup>2</sup>-sec </td><td> <font face="courier" color="green">float</font> </td><td>Net rate of carbon transfer per unit one-sided area.  </td></tr>
</table>
<h1><a class="anchor" id="PhotoDescription"></a>
Introduction</h1>
<p>The photosynthesis plug-in implements two types of models: an empirical model similar to that of <a href="../../plugins/photosynthesis/doc/Johnson_2010_PlantMod.pdf">Johnson (2010)</a>; and the biochemical model of <a href="https://link.springer.com/article/10.1007/BF00386231">Farquhar, von Caemmerer, and Berry (1980)</a>, which are described separately below.</p>
<p>By default, the plug-in uses the empirical model. There are functions that can be used to switch between the two types of available models, as illustrated below.</p>
<div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.4"> <pre><code> #include "PhotosynthesisModel.h"</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.4"><pre><code> int main( void ){
   PhotosynthesisModel photosynthesismodel(&amp;context);</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.4"><pre><code>   <code></code>//Use the Farquahar-von Caemmerer-Berry model
   photosynthesismodel.setModelType_Farquhar();</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.4"><pre><code>   photosynthesismodel.run();</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.4"><pre><code>   <code></code>//Switch back to the empirical model
   photosynthesismodel.setModelType_Empirical();
 }</code></pre> </div><h1><a class="anchor" id="EmpiricalDescription"></a>
Empirical Model Description</h1>
<p>The net photosynthetic rate is described by the equation:</p>
<p><img class="formulaInl" alt="$A = A_{sat} f_L f_T f_C - R_d$" src="form_25.png"/></p>
<p><img class="formulaInl" alt="$A_{sat}\,({\mu}mol/m^2-s)$" src="form_26.png"/> is the photosynthesis assimilation rate at saturating irradiance and reference temperature ( <img class="formulaInl" alt="$T_{ref}$" src="form_27.png"/>) and intercellular CO<sub>2</sub> concentration ( <img class="formulaInl" alt="$C_{i,ref}$" src="form_28.png"/>).</p>
<h2><a class="anchor" id="LightResponse"></a>
Light Response Function</h2>
<p>The response of photosynthesis to light is given by a simple exponential function, which is defined by only one parameter:</p>
<p><img class="formulaInl" alt="$f_L(i) = \dfrac{i}{\theta+i}$" src="form_103.png"/>,</p>
<p>where <img class="formulaInl" alt="$\theta$" src="form_3.png"/> is the light response curvature.</p>
<h2><a class="anchor" id="TempResponse"></a>
Temperature Response</h2>
<p>It is assumed that the maximum CO<sub>2</sub> assimilation rate <img class="formulaInl" alt="$A_{max}$" src="form_30.png"/> decreases exponentially about some optimum temperature <img class="formulaInl" alt="$T_{opt}$" src="form_31.png"/>. The temperature response function is given by:</p>
<p><img class="formulaInl" alt="$f_T(T_s) = \left(\dfrac{T_s-T_{min}}{T_{ref}-T_{min}}\right)^q\left(\dfrac{(1+q)T_{opt}-T_{min}-qT_s}{(1+q)T_{opt}-T_{min}-qT_{ref}}\right)$" src="form_116.png"/>,</p>
<p>where <img class="formulaInl" alt="$T_{min}$" src="form_33.png"/> is the minimum temperature at which assimilation occurs, <img class="formulaInl" alt="$T_{opt}$" src="form_31.png"/> is the temperature at which the maximum assimilation rate occurs, <img class="formulaInl" alt="$T_{ref}$" src="form_27.png"/> is the reference temperature chosen to define <img class="formulaInl" alt="$A_{ref}$" src="form_34.png"/>, and <img class="formulaInl" alt="$q$" src="form_35.png"/> is a shape parameter.</p>
<p>The "dark" respiration rate <img class="formulaInl" alt="$R_d$" src="form_36.png"/> is assumed to increase exponentially with temperature following the Arrhenius equation (and assumed not to vary with ambient CO<sub>2</sub> concentration). Thus, the dark respiration rate is calculated simply as</p>
<p><img class="formulaInl" alt="$R_d = R\sqrt{T_s}\mathrm{exp}\left(-E_R/(T_s+273)\right)$" src="form_117.png"/>,</p>
<p>where <img class="formulaInl" alt="$R$" src="form_6.png"/> and <img class="formulaInl" alt="$E_R$" src="form_38.png"/> are parameters, and temperature is in Kelvin.</p>
<h2><a class="anchor" id="CO2Response"></a>
CO2 Response Function</h2>
<p>We assume that the maximum assimilation rate varies linearly with intercellular CO<sub>2</sub> concentration over the range of expected concentrations, and is zero at zero CO<sub>2</sub>. Thus, the response function is simply</p>
<p><img class="formulaInl" alt="$f_C(C_i) = k_C\dfrac{C_i}{C_{i,ref}}$" src="form_105.png"/>,</p>
<p>where <img class="formulaInl" alt="$C_i$" src="form_40.png"/> is intercellular CO<sub>2</sub> concentration ( <img class="formulaInl" alt="$\mu$" src="form_24.png"/>mol CO<sub>2</sub>/mol air).</p>
<h2><a class="anchor" id="Ci"></a>
Intercellular CO2 Concentration</h2>
<p>The intercellular CO<sub>2</sub> concentration is estimated as a function of the boundary-layer conductance, stomatal conductance, and ambient CO<sub>2</sub> concentration outside of the primitive boundary-layer. The rate of transport of CO<sub>2</sub> to the leaf (i.e., assimilation rate) is given by</p>
<p><img class="formulaInl" alt="$A+R_d = 0.75g_M\left(C_{amb}-C_i\right)$" src="form_41.png"/>,</p>
<p>where <img class="formulaInl" alt="$g_M$" src="form_10.png"/> is the conductance to moisture from the substomtal cells to outside of the boundary-layer. The 0.75 factor comes from the fact that diffusion of CO<sub>2</sub> in air is slower than that of water vapor (see Eq. 7.33 of <a href="http://www.springer.com/us/book/9780387949376#otherversion=9781461216261">Campbell and Norman</a>).</p>
<p>Since <img class="formulaInl" alt="$A$" src="form_42.png"/> is dependent on <img class="formulaInl" alt="$C_i$" src="form_40.png"/> and vice-versa, an iterative solution is requred for <img class="formulaInl" alt="$A$" src="form_42.png"/>.</p>
<h2><a class="anchor" id="PhotoCalib"></a>
Empirical Model Calibration Procedure</h2>
<h3><a class="anchor" id="PhotoVars"></a>
Summary of Empirical Model Independent Variables</h3>
<table class="doxtable">
<tr>
<th>Variable </th><th>Units </th><th>Description  </th></tr>
<tr>
<td><img class="formulaInl" alt="$i$" src="form_43.png"/> </td><td>W/m<sup>2</sup> </td><td>Photosynthetic radiation energy flux.  </td></tr>
<tr>
<td><img class="formulaInl" alt="$T_s$" src="form_7.png"/> </td><td>Kelvin </td><td>Surface temperature.  </td></tr>
<tr>
<td><img class="formulaInl" alt="$C_{amb}$" src="form_45.png"/> </td><td><img class="formulaInl" alt="$\mu$" src="form_24.png"/>mol CO<sub>2</sub>/mol air </td><td>Ambient CO<sub>2</sub> concentration outside of boundary-layer.  </td></tr>
<tr>
<td><img class="formulaInl" alt="$g_{bl}$" src="form_46.png"/> </td><td>mol air/m<sup>2</sup>-s </td><td>Boundary-layer conductance.  </td></tr>
<tr>
<td><img class="formulaInl" alt="$g_s$" src="form_47.png"/> </td><td>mol air/m<sup>2</sup>-s </td><td>Stomatal conductance.  </td></tr>
</table>
<h3><a class="anchor" id="PhotoParams"></a>
Summary of Empirical Model Parameters</h3>
<table class="doxtable">
<tr>
<th>Parameter </th><th>Units </th><th>Description  </th></tr>
<tr>
<td><img class="formulaInl" alt="$A_{sat}$" src="form_48.png"/> </td><td>mol CO<sub>2</sub>/m<sup>2</sup>-sec </td><td>Assimilation rate at saturating irradiance and reference temperature and intercellular CO<sub>2</sub> concentration.  </td></tr>
<tr>
<td><img class="formulaInl" alt="$\theta$" src="form_3.png"/> </td><td>W/m<sup>2</sup> </td><td>Shape parameter for response to light.  </td></tr>
<tr>
<td><img class="formulaInl" alt="$T_{min}$" src="form_33.png"/> </td><td>Kelvin </td><td>Minimum temperature at which assimilation occurs.  </td></tr>
<tr>
<td><img class="formulaInl" alt="$T_{opt}$" src="form_31.png"/> </td><td>Kelvin </td><td>Temperature at which maximum assimilation rate occurs.  </td></tr>
<tr>
<td><img class="formulaInl" alt="$q$" src="form_35.png"/> </td><td>unitless </td><td>Temperature response shape function.  </td></tr>
<tr>
<td><img class="formulaInl" alt="$R$" src="form_6.png"/> </td><td><img class="formulaInl" alt="${\mu}$" src="form_49.png"/>mol K<sup>1/2</sup>/m<sup>2</sup>-s </td><td>Pre-exponential factor for respiration temperature response.  </td></tr>
<tr>
<td><img class="formulaInl" alt="$E_R$" src="form_38.png"/> </td><td>1/Kelvin </td><td>Respiration temperature response rate.  </td></tr>
<tr>
<td><img class="formulaInl" alt="$k_C$" src="form_50.png"/> </td><td>unitless </td><td>CO<sub>2</sub> response rate.  </td></tr>
</table>
<h3><a class="anchor" id="PhotoLightParam"></a>
Response of Assimilation Rate to Light</h3>
<p>The response of the assimilation rate to light is obtained from gas exchange measurements at reference temperature ( <img class="formulaInl" alt="$T_{ref}$" src="form_27.png"/>) and CO<sub>2</sub> ( <img class="formulaInl" alt="$C_{i,ref}$" src="form_28.png"/>) in which the irradiance is varied across some range. However, one important detail is that the dark respiration rate should be removed such that <img class="formulaInl" alt="$A=0$" src="form_51.png"/> in the dark (see plot below). This can be done by measuring the net CO<sub>2</sub> flux starting in the dark, then subtracting the dark flux from the total flux for each subsequent light level.</p>
<div class="image">
<img src="LightResponse.png" alt="LightResponse.png"/>
</div>
<h3><a class="anchor" id="PhotoTempParam"></a>
Response of Assimilation Rate to Temperature</h3>
<p>The response of the assimilation rate to temperature is obtained using gas exchange measurements at saturating light levels and the reference CO<sub>2</sub> concentration. The temperature is varied across some range, and the assimilation rate is measured. It is assumed that the optimum temperature <img class="formulaInl" alt="$T_{opt}$" src="form_31.png"/> is the temperature corresponding to the maximum measured assimilation rate. The model is fit to the data to determine <img class="formulaInl" alt="$T_{min}$" src="form_33.png"/> and <img class="formulaInl" alt="$q$" src="form_35.png"/>.</p>
<div class="image">
<img src="TempResponse.png" alt="TempResponse.png"/>
</div>
<h3><a class="anchor" id="PhotoRespParam"></a>
Response of Respiration Rate to Temperature</h3>
<p>The response of the dark respiration to temperature is obtained using gas exchange measurements in the dark. The leaf is first acclimated to the dark chamber, then leaf temperature is varied across some range. The model is then fit to the data to determine parameters.</p>
<div class="image">
<img src="RespResponse.png" alt="RespResponse.png"/>
</div>
<h3><a class="anchor" id="PhotoCO2Param"></a>
Response of Assimilation Rate to CO2</h3>
<p>The response of the assimilation rate is obtained using gas exchange measurements at saturating light levels and the reference temperature <img class="formulaInl" alt="$T_{ref}$" src="form_27.png"/>, but with varying external CO<sub>2</sub> concentration (which produces varying intercellular CO<sub>2</sub>).</p>
<div class="image">
<img src="CO2Response.png" alt="CO2Response.png"/>
</div>
<h1><a class="anchor" id="FarquharDescription"></a>
Farquhar, von Caemmerer, Berry Model Description</h1>
<p>The model of <a href="https://link.springer.com/article/10.1007/BF00386231">Farquhar, von Caemmerer, and Berry (1980)</a> is a biochemical model of photosynthesis. The form used here predicts photosynthetic production as a function of photoshynthetically active radiation flux, ambient CO<sub>2</sub> concentration, and stomatal conductance, which may itself provide responses to a number of additional environmental variables.</p>
<p>The implementation used here calculates the net rate of CO<sub>2</sub> exchange as</p>
<p><img class="formulaInl" alt="$A=\left(1-\dfrac{\Gamma^*}{C_i}\right)\mathrm{min}\left\{W_c,W_j\right\}-R_d$" src="form_161.png"/></p>
<p>where</p>
<p><img class="formulaInl" alt="$W_c=\dfrac{V_{cmax}C_i}{C_i+K_{co}}$" src="form_154.png"/></p>
<p>is the rate limited by Rubisco, and</p>
<p><img class="formulaInl" alt="$W_j=\dfrac{J C_i}{4C_i+8\Gamma^*}$" src="form_155.png"/></p>
<p>is the rate limited by RuBP regeneration, and the potential electron transport rate <img class="formulaInl" alt="$J$" src="form_156.png"/> is assumed to follow a rectangular hyperbolic relationship</p>
<p><img class="formulaInl" alt="$J=\dfrac{\alpha J_{max} i}{\alpha i + J_{max}}$" src="form_162.png"/>.</p>
<p>Note that a limitation state based on TPU utilization is not included in the model for simplicity.</p>
<p>The intercellular CO<sub>2</sub> concentration <img class="formulaInl" alt="$C_i$" src="form_40.png"/> is determined from the relation</p>
<p><img class="formulaInl" alt="$A+R_d=0.75g_M\left(C_{amb}-C_i\right)$" src="form_163.png"/></p>
<p>which is solved numerically using the Secant method, since <img class="formulaInl" alt="$A$" src="form_42.png"/> is a complex nonlinear function of <img class="formulaInl" alt="$C_i$" src="form_40.png"/> which prevents an analytical solution for <img class="formulaInl" alt="$C_i$" src="form_40.png"/>. The 0.75 factor comes from the fact that diffusion of CO<sub>2</sub> in air is slower than that of water vapor (see Eq. 7.33 of <a href="http://www.springer.com/us/book/9780387949376#otherversion=9781461216261">Campbell and Norman</a>).</p>
<p>The "dark" respiration rate <img class="formulaInl" alt="$R_d$" src="form_36.png"/> is assumed to increase exponentially with temperature following the Arrhenius equation (and assumed not to vary with ambient CO<sub>2</sub> concentration). Thus, the dark respiration rate is calculated simply as</p>
<p><img class="formulaInl" alt="$R_d = R\sqrt{T_s}\mathrm{exp}\left(-E_R/(T_s+273)\right)$" src="form_117.png"/>,</p>
<p>where <img class="formulaInl" alt="$R$" src="form_6.png"/> and <img class="formulaInl" alt="$E_R$" src="form_38.png"/> are parameters, and temperature is in Kelvin.</p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
