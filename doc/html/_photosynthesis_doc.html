<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>.: Helios Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-93BB4673PE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-93BB4673PE');
</script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3F0Y5Z6543"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-3F0Y5Z6543');
</script>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Helios_logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname"><span id="projectnumber">&#160;v1.3.19</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="_plug_ins.html">Plug-ins</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Photosynthesis Model Plugin Documentation</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#PhotoConstructor">Class Constructor</a>
  </li>
  <li class="level1">
    <a href="#PhotoVarsAndProps">Primitive Data</a>
    <ul>
      <li class="level2">
        <a href="#PhotoInputData">Input Primitive Data</a>
      </li>
      <li class="level2">
        <a href="#PhotoOutputData">Default Output Primitive Data</a>
      </li>
      <li class="level2">
        <a href="#PhotoOptionalOutputData">Optional Output Primitive Data</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#PhotoDescription">Introduction</a>
  </li>
  <li class="level1">
    <a href="#FarquharDescription">Farquhar, von Caemmerer, Berry Model Description</a>
    <ul>
      <li class="level2">
        <a href="#FvCBtemperature">Temperature response of model parameters</a>
        <ul>
          <li class="level3">
            <a href="#FvCBPhotoVars">Summary of FvCB Model Independent Variables</a>
          </li>
          <li class="level3">
            <a href="#FvCBPhotoParams">Summary of FvCB Model Parameters</a>
          </li>
          <li class="level3">
            <a href="#FvCBSettingPhotoParams">Setting FvCB Model Parameters</a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#EmpiricalDescription">Empirical Model Description</a>
    <ul>
      <li class="level2">
        <a href="#LightResponse">Light Response Function</a>
      </li>
      <li class="level2">
        <a href="#TempResponse">Temperature Response</a>
      </li>
      <li class="level2">
        <a href="#CO2Response">CO2 Response Function</a>
      </li>
      <li class="level2">
        <a href="#Ci">Intercellular CO2 Concentration</a>
      </li>
      <li class="level2">
        <a href="#PhotoCalib">Empirical Model Calibration Procedure</a>
        <ul>
          <li class="level3">
            <a href="#PhotoVars">Summary of Empirical Model Independent Variables</a>
          </li>
          <li class="level3">
            <a href="#PhotoParams">Summary of Empirical Model Parameters</a>
          </li>
          <li class="level3">
            <a href="#PhotoLightParam">Response of Assimilation Rate to Light</a>
          </li>
          <li class="level3">
            <a href="#PhotoTempParam">Response of Assimilation Rate to Temperature</a>
          </li>
          <li class="level3">
            <a href="#PhotoRespParam">Response of Respiration Rate to Temperature</a>
          </li>
          <li class="level3">
            <a href="#PhotoCO2Param">Response of Assimilation Rate to CO2</a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><table class="doxtable">
<tr>
<th>Dependencies</th><td>None </td></tr>
<tr>
<th>CMakeLists.txt</th><td>set( PLUGINS "photosynthesis" ) </td></tr>
<tr>
<th>Header File</th><td>#include "PhotosynthesisModel.h" </td></tr>
<tr>
<th>Class</th><td><a class="el" href="class_photosynthesis_model.html">PhotosynthesisModel</a> </td></tr>
</table>
<h1><a class="anchor" id="PhotoConstructor"></a>
Class Constructor</h1>
<table class="doxtable">
<tr>
<th>Constructors </th></tr>
<tr>
<td><a class="el" href="class_photosynthesis_model.html">PhotosynthesisModel( helios::Context* )</a> </td></tr>
</table>
<h1><a class="anchor" id="PhotoVarsAndProps"></a>
Primitive Data</h1>
<h2><a class="anchor" id="PhotoInputData"></a>
Input Primitive Data</h2>
<table class="doxtable">
<tr>
<th>Primitive Data Label</th><th>Symbol</th><th>Units</th><th>Data Type</th><th>Description</th><th>Available Plug-ins</th><th>Default Value </th></tr>
<tr>
<td>radiation_flux_PAR</td><td><img class="formulaInl" alt="$Q$" src="form_92.png" width="12" height="15"/></td><td>W/m<sup>2</sup></td><td> <font face="courier" color="green">float</font></td><td>Radiative flux in PAR band. NOTE: this is automatically converted to units of photon flux density, which are the units used in the photosynthesis model.</td><td>Can be computed by <a class="el" href="class_radiation_model.html">RadiationModel</a> plug-in.</td><td>0 </td></tr>
<tr>
<td>temperature</td><td><img class="formulaInl" alt="$T_s$" src="form_61.png" width="15" height="14"/></td><td>Kelvin</td><td> <font face="courier" color="green">float</font></td><td>Primitive surface temperature.</td><td>Can be computed by <a class="el" href="class_energy_balance_model.html">EnergyBalanceModel</a> plug-in.</td><td>300 K </td></tr>
<tr>
<td>air_CO2</td><td><img class="formulaInl" alt="$C_a$" src="form_93.png" width="17" height="15"/></td><td><img class="formulaInl" alt="$\mu$" src="form_94.png" width="11" height="11"/>mol CO<sub>2</sub>/mol air</td><td> <font face="courier" color="green">float</font></td><td>CO<sub>2</sub> concentration of air outside of primitive boundary-layer.</td><td>N/A</td><td>390 <img class="formulaInl" alt="$\mu$" src="form_94.png" width="11" height="11"/>mol/mol </td></tr>
<tr>
<td>moisture_conductance</td><td><img class="formulaInl" alt="$g_S$" src="form_62.png" width="17" height="11"/></td><td>mol air/m<sup>2</sup>-s</td><td> <font face="courier" color="green">float</font></td><td>Conductance to moisture between sub-stomatal cells and leaf surface (i.e., stomatal conductance).</td><td>Can be computed by <a class="el" href="class_stomatal_conductance_model.html">StomatalConductanceModel</a> plug-in.</td><td>0.25 mol/m<sup>2</sup>-s </td></tr>
<tr>
<td>boundarylayer_conductance**</td><td><img class="formulaInl" alt="$g_H$" src="form_26.png" width="20" height="11"/></td><td>mol air/m<sup>2</sup>-s</td><td> <font face="courier" color="green">float</font></td><td>Conductance to heat between leaf surface and outside of the boundary-layer (i.e., boundary-layer conductance).</td><td>Can be computed by <a class="el" href="class_b_l_conductance_model.html">BLConductanceModel</a> plug-in, or by <a class="el" href="class_energy_balance_model.html">EnergyBalanceModel</a> plug-in if optional output primitive data "boundarylayer_conductance_out" is enabled.</td><td>1.0 mol/m<sup>2</sup>-s </td></tr>
<tr>
<td>twosided_flag </td><td>N/A </td><td>N/A </td><td> <font face="courier" color="green">uint</font> </td><td>Flag indicating the number of primitive faces with heat transfer (twosided_flag = 0 for one-sided heat transfer; twosided_flag = 1 for two-sided heat transfer). </td><td>N/A </td><td>1  </td></tr>
<tr>
<td>stomatal_sidedness </td><td><img class="formulaInl" alt="$\zeta$" src="form_74.png" width="8" height="15"/> </td><td>unitless </td><td> <font face="courier" color="green">float</font> </td><td>Ratio of stomatal density on the upper leaf surface to the sum of the stomatal density on upper and lower leaf surfaces. Note: if "twosided_flag" is equal to 0, stomatal_sidedness will be automatically set to 0.</td><td>N/A </td><td>0  </td></tr>
</table>
<p>**The photosynthesis model will also check for primitive data "boundarylayer_conductance_out" if "boundarylayer_conductance" does not exist. If you are using the energy balance model to calculate the boundary-layer conductance, you should enable optional output primitive data "boundarylayer_conductance_out" so that other plug-ins can use it.</p>
<h2><a class="anchor" id="PhotoOutputData"></a>
Default Output Primitive Data</h2>
<table class="doxtable">
<tr>
<th>Primitive Data Label</th><th>Symbol</th><th>Units</th><th>Data Type</th><th>Description</th></tr>
<tr>
<td>net_photosynthesis</td><td><img class="formulaInl" alt="$A$" src="form_95.png" width="12" height="12"/></td><td><img class="formulaInl" alt="$\mu$" src="form_94.png" width="11" height="11"/>mol CO<sub>2</sub>/m<sup>2</sup>-sec</td><td> <font face="courier" color="green">float</font></td><td>Net rate of carbon transfer per unit one-sided area. </td></tr>
</table>
<h2><a class="anchor" id="PhotoOptionalOutputData"></a>
Optional Output Primitive Data</h2>
<table class="doxtable">
<tr>
<th>Primitive Data Label</th><th>Symbol</th><th>Units</th><th>Data Type</th><th>Description </th></tr>
<tr>
<td>Ci</td><td><img class="formulaInl" alt="$C_i$" src="form_96.png" width="15" height="15"/></td><td><img class="formulaInl" alt="$\mu$" src="form_94.png" width="11" height="11"/>mol CO<sub>2</sub>/mol</td><td> <font face="courier" color="green">float</font></td><td>Intercellular CO<sub>2</sub> concentration. </td></tr>
<tr>
<td>Gamma_CO2</td><td><img class="formulaInl" alt="$\Gamma$" src="form_97.png" width="11" height="12"/></td><td><img class="formulaInl" alt="$\mu$" src="form_94.png" width="11" height="11"/>mol CO<sub>2</sub>/mol</td><td> <font face="courier" color="green">float</font></td><td>Photosynthetic CO<sub>2</sub> compensation point (including "dark respiration"). </td></tr>
<tr>
<td>limitation_state</td><td>N/A</td><td>N/A</td><td> <font face="courier" color="green">int</font></td><td>Photosynthesis limitation state. limitation_state=0 if photosynthesis is Rubisco-limited, limitation_state=1 if photosynthesis is electron transport limited. </td></tr>
</table>
<h1><a class="anchor" id="PhotoDescription"></a>
Introduction</h1>
<p>The photosynthesis plug-in implements two types of models: the biochemical model of <a href="https://link.springer.com/article/10.1007/BF00386231">Farquhar, von Caemmerer, and Berry (1980)</a>, and an empirical model similar to that of <a href="../../plugins/photosynthesis/doc/Johnson_2010_PlantMod.pdf">Johnson (2010)</a>, which are described separately below.</p>
<p>By default, the plug-in uses the biochemical model. The model can either be set explicitly, as illustrated in the code below, or the model type will be inferred based on the model coefficients that are set (see descriptions below).</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_photosynthesis_model_8h.html">PhotosynthesisModel.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(){</div>
<div class="line">  <a class="code hl_class" href="class_photosynthesis_model.html">PhotosynthesisModel</a> photosynthesismodel(&amp;context);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Use the Farquahar-von Caemmerer-Berry model</span></div>
<div class="line">  photosynthesismodel.setModelType_Farquhar();</div>
<div class="line"> </div>
<div class="line">  photosynthesismodel.run();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Switch back to the empirical model</span></div>
<div class="line">  photosynthesismodel.setModelType_Empirical();</div>
<div class="line">}</div>
<div class="ttc" id="a_photosynthesis_model_8h_html"><div class="ttname"><a href="_photosynthesis_model_8h.html">PhotosynthesisModel.h</a></div></div>
<div class="ttc" id="aclass_photosynthesis_model_html"><div class="ttname"><a href="class_photosynthesis_model.html">PhotosynthesisModel</a></div><div class="ttdef"><b>Definition</b> <a href="_photosynthesis_model_8h_source.html#l00247">PhotosynthesisModel.h:247</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="FarquharDescription"></a>
Farquhar, von Caemmerer, Berry Model Description</h1>
<p>The model of <a href="https://link.springer.com/article/10.1007/BF00386231">Farquhar, von Caemmerer, and Berry (1980)</a> is a biochemical model of photosynthesis. The form used here predicts photosynthetic production as a function of photoshynthetically active radiation flux, ambient CO<sub>2</sub> concentration, and stomatal conductance, which may itself provide responses to a number of additional environmental variables.</p>
<p>The implementation used here calculates the net rate of CO<sub>2</sub> exchange as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[A=\left(1-\frac{\Gamma^*}{C_i}\right)\mathrm{min}\left\{W_c,W_j\right\}-R_d,\]" src="form_98.png" width="233" height="38"/>
</p>
<p>where</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[W_c=\frac{V_{cmax}C_i}{C_i+K_{co}}\]" src="form_99.png" width="101" height="35"/>
</p>
<p>is the rate limited by Rubisco, with</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[K_{co}=K_c\left(1+\frac{O}{K_O}\right),\]" src="form_100.png" width="146" height="38"/>
</p>
<p>where <img class="formulaInl" alt="$O$" src="form_101.png" width="12" height="12"/> is oxygen concentration.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[W_j=\dfrac{J C_i}{4C_i+8\Gamma^*}\]" src="form_102.png" width="108" height="35"/>
</p>
<p>is the rate limited by RuBP regeneration.</p>
<p>The light response of <img class="formulaInl" alt="$J$" src="form_103.png" width="9" height="12"/>, the potential electron transport rate, can be described as a rectangular hyperbola with 1 shape parameter, or non-rectangular hyperbola with 2 shape parameters. The rectangular hyperbola takes the form</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ J(Q) = \dfrac{J_{max} \alpha Q}{\alpha Q + J_{max}} \]" src="form_104.png" width="128" height="36"/>
</p>
<p>where <img class="formulaInl" alt="$Q$" src="form_92.png" width="12" height="15"/> is the photosynthetically active absorbed radiation flux ( <img class="formulaInl" alt="$\mu mol\,m^{-2}\,s^{-1}$" src="form_105.png" width="92" height="17"/>), <img class="formulaInl" alt="$J_{max}$" src="form_106.png" width="32" height="15"/> is the temperature-dependent maximum potential electron transport rate ( <img class="formulaInl" alt="$\mu mol\,m^{-2}\,s^{-1}$" src="form_105.png" width="92" height="17"/>), and <img class="formulaInl" alt="$\alpha$" src="form_107.png" width="9" height="8"/> is the intrinsic quantum efficiency of electron transport ( <img class="formulaInl" alt="$electron\,photon^{-1}$" src="form_108.png" width="116" height="17"/>) which defines the initial slope of the light response, determines its resulting shape in the rectangular hyperbolic form, and is thought to be relatively conserved around 0.5. The non-rectangular hyperbola takes the form</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[J(Q) = \dfrac{\alpha Q + J_{max} - \sqrt{(\alpha Q + J_{max})^2 - 4 \theta \alpha Q J_{max}}}{2 \theta}\]" src="form_109.png" width="341" height="35"/>
</p>
<p>where <img class="formulaInl" alt="$\theta$" src="form_19.png" width="8" height="12"/> is an additional parameter (unitless) that shapes the light response curve beyond its initial slope. When <img class="formulaInl" alt="$\theta$" src="form_19.png" width="8" height="12"/> approaches zero, the two forms become equivalent. In Photosynthesis Plugin, the rectangular form will be assumed unless <img class="formulaInl" alt="$\theta$" src="form_19.png" width="8" height="12"/> is specified by the user.</p>
<p>The intercellular CO<sub>2</sub> concentration <img class="formulaInl" alt="$C_i$" src="form_96.png" width="15" height="15"/> is determined from the relation</p>
<p><img class="formulaInl" alt="$A=0.75g_M\left(C_{a}-C_i\right)$" src="form_110.png" width="144" height="17"/></p>
<p>which is solved numerically using the Secant method, since <img class="formulaInl" alt="$A$" src="form_95.png" width="12" height="12"/> is a complex nonlinear function of <img class="formulaInl" alt="$C_i$" src="form_96.png" width="15" height="15"/> which prevents an analytical solution for <img class="formulaInl" alt="$C_i$" src="form_96.png" width="15" height="15"/>. The 0.75 factor comes from the fact that diffusion of CO<sub>2</sub> in air is slower than that of water vapor (see Eq. 7.33 of <a href="http://www.springer.com/us/book/9780387949376#otherversion=9781461216261">Campbell and Norman</a>).</p>
<p><img class="formulaInl" alt="$g_M$" src="form_63.png" width="21" height="11"/> is the conductance to moisture transfer between the leaf interior and just outside of the leaf boundary-layer, and is calculated as</p>
<p><img class="formulaInl" alt="$g_M = 1.08g_Hg_S\left[\dfrac{\zeta}{1.08g_H+g_S\zeta}+\dfrac{(1-\zeta)}{1.08g_H+g_S(1-\zeta)}\right]$" src="form_78.png" width="354" height="38"/>,</p>
<p>where <img class="formulaInl" alt="$g_H$" src="form_26.png" width="20" height="11"/> is the boundary-layer conductance to heat, and <img class="formulaInl" alt="$1.08g_H$" src="form_79.png" width="45" height="14"/> gives the boundary-layer conductance to moisture considering the differences in diffusivity between water vapor and heat. <img class="formulaInl" alt="$n_s$" src="form_27.png" width="15" height="11"/> is the number of primitive faces, which is determined by the value of primitive data "twosided_flag" (twosided_flag=0 is single-sided and <img class="formulaInl" alt="$n_s=1$" src="form_28.png" width="44" height="14"/>, twosided_flag=1 is two-sided and <img class="formulaInl" alt="$n_s=2$" src="form_29.png" width="44" height="14"/>).</p>
<p><img class="formulaInl" alt="$\zeta=\dfrac{D_{upper}}{D_{lower}+D_{upper}}$" src="form_80.png" width="135" height="36"/></p>
<p>is the stomatal sidedness, which is the ratio of the stomatal density of the upper leaf surface to the sum of the upper and lower leaf surface densities, which is set by the primitive data value "stomatal_sidedness". For leaves, <img class="formulaInl" alt="$\zeta=0$" src="form_81.png" width="35" height="15"/> corresponds to hypostomatous leaves (stomata on one side), and <img class="formulaInl" alt="$\zeta=0.5$" src="form_82.png" width="47" height="15"/> to amphistomatous leaves (stomata equally on both sides). It is important to note that if <img class="formulaInl" alt="$n_s=1$" src="form_28.png" width="44" height="14"/>, then the value of <img class="formulaInl" alt="$\zeta$" src="form_74.png" width="8" height="15"/> will be overridden and set to 0.</p>
<h2><a class="anchor" id="FvCBtemperature"></a>
Temperature response of model parameters</h2>
<p>Two different temperature response functions are commonly used in photosynthetic modeling and supported in the Photosynthesis Plugin. One is an Arrhenius equation, which is exponentially increasing with no decline in the region of use. The other is a modified Arrhenius equation with a peak or temperature optimum, beyond which there is a decline in the value of the function, representing a denaturing of an enzyme and subsequent reduction of its activity.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[
 \begin{aligned}
 k &amp;= k_{25} \cdot \exp \left[\frac{\Delta H_a}{R} \left(\frac{1}{298}-\frac{1}{T_{leaf}} \right) \right] \frac{f(298)}{f(T_{leaf})}, \\
 f(T_{leaf}) &amp;= 1+\exp \left[\frac{\Delta H_d}{R} \left(\frac{1}{T_{opt}} - \frac{1}{T_{leaf}} \right) - \ln \left(\frac{\Delta H_d}{\Delta H_a}-1 \right) \right]
 \end{aligned}
 \]" src="form_111.png" width="398" height="81"/>
</p>
<p>In this form, the model is conveniently parameterized by the commonly used standard reference rate at 25 <img class="formulaInl" alt="$^\circ$" src="form_112.png" width="6" height="6"/>C, <img class="formulaInl" alt="$k_{25}$" src="form_113.png" width="20" height="15"/>, as well as the energy of activation, <img class="formulaInl" alt="$A = \Delta H_a = dH_a$" src="form_114.png" width="111" height="15"/> of the Arrhenius equation, but also by the observable temperature optimum, <img class="formulaInl" alt="$T_{opt}$" src="form_115.png" width="27" height="15"/> and one additional fitted parameter, the energy of deactivation, <img class="formulaInl" alt="$D = \Delta H _d = dH_d$" src="form_116.png" width="111" height="15"/>, related to the rate of decline from the optimum.</p>
<p>As <img class="formulaInl" alt="$T_{opt}$" src="form_115.png" width="27" height="15"/> <img class="formulaInl" alt="$\to \infty$" src="form_117.png" width="33" height="9"/>, then the peaked form approaches the standard, unpeaked Arrhenius equation, allowing for mathematical backwards compatibility for parameters obtained from fitting to the standard unpeaked form.</p>
<p>In the Photosynthesis Plugin, the Arrhenius form will be assumed as it requires fewer parameters, unless the additional parameters <img class="formulaInl" alt="$dH_d$" src="form_118.png" width="27" height="15"/> and <img class="formulaInl" alt="$T_{opt}$" src="form_115.png" width="27" height="15"/> are specified by the user.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Units    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><img class="formulaInl" alt="$k_{25}$" src="form_113.png" width="20" height="15"/>   </td><td class="markdownTableBodyNone">reference rate at 25 <img class="formulaInl" alt="$^\circ$" src="form_112.png" width="6" height="6"/>C   </td><td class="markdownTableBodyNone"><img class="formulaInl" alt="$\mu mol\,m^{-2}\,s^{-1}$" src="form_105.png" width="92" height="17"/>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><img class="formulaInl" alt="$dH_a$" src="form_119.png" width="27" height="15"/>   </td><td class="markdownTableBodyNone">activation energy (rate of increase)   </td><td class="markdownTableBodyNone"><img class="formulaInl" alt="$kJ\,mol^{-1}$" src="form_120.png" width="60" height="14"/>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><img class="formulaInl" alt="$dH_d$" src="form_118.png" width="27" height="15"/>   </td><td class="markdownTableBodyNone">deactivation energy (rate of decrease)   </td><td class="markdownTableBodyNone"><img class="formulaInl" alt="$kJ\,mol^{-1}$" src="form_120.png" width="60" height="14"/>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><img class="formulaInl" alt="$T_{opt}$" src="form_115.png" width="27" height="15"/>   </td><td class="markdownTableBodyNone">optimum temperature in Kelvin   </td><td class="markdownTableBodyNone"><img class="formulaInl" alt="$K$" src="form_121.png" width="14" height="12"/>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><img class="formulaInl" alt="$T_{leaf}$" src="form_122.png" width="33" height="15"/>   </td><td class="markdownTableBodyNone">leaf surface temperature in Kelvin   </td><td class="markdownTableBodyNone"><img class="formulaInl" alt="$K$" src="form_121.png" width="14" height="12"/>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><img class="formulaInl" alt="$R$" src="form_1.png" width="12" height="12"/>   </td><td class="markdownTableBodyNone">ideal gas constant, 0.008314   </td><td class="markdownTableBodyNone"><img class="formulaInl" alt="$kJ\,mol^{-1}\,K^{-1}$" src="form_123.png" width="93" height="14"/>   </td></tr>
</table>
<p>Additional temperature parameters that are not typically fit to use the standard Arrhenius form with the parameters obtained by <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/j.1365-3040.2001.00668.x">Bernacchi et al. (2001)</a>, and are given by the following equations</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[
 \begin{aligned}
 \Gamma^* &amp;= 42.60 \cdot \exp \left[ \frac{37.83}{R} \left(\frac{1}{298} - \frac{1}{T_{leaf}} \right) \right] \\
 K_c &amp;= 400.3 \cdot \exp \left[ \frac{79.43}{R} \left(\frac{1}{298} - \frac{1}{T_{leaf}} \right) \right] \\
 K_o &amp;= 275.1 \cdot \exp \left[ \frac{36.38}{R} \left(\frac{1}{298} - \frac{1}{T_{leaf}} \right) \right] \\
 R_d &amp;= R_{d,25} \cdot \exp \left[ \frac{46.39}{R} \left(\frac{1}{298} - \frac{1}{T_{leaf}} \right) \right]
 \end{aligned}
 \]" src="form_124.png" width="266" height="165"/>
</p>
<h3><a class="anchor" id="FvCBPhotoVars"></a>
Summary of FvCB Model Independent Variables</h3>
<table class="doxtable">
<tr>
<th>Variable</th><th>Units</th><th>Description </th></tr>
<tr>
<td><img class="formulaInl" alt="$Q$" src="form_92.png" width="12" height="15"/></td><td><img class="formulaInl" alt="$\mu$" src="form_94.png" width="11" height="11"/>mol/m<sup>2</sup>-sec.</td><td>Photosynthetic radiation energy flux. </td></tr>
<tr>
<td><img class="formulaInl" alt="$T_s$" src="form_61.png" width="15" height="14"/></td><td>Kelvin</td><td>Surface temperature. </td></tr>
<tr>
<td><img class="formulaInl" alt="$C_{a}$" src="form_125.png" width="17" height="15"/></td><td><img class="formulaInl" alt="$\mu$" src="form_94.png" width="11" height="11"/>mol CO<sub>2</sub>/mol air</td><td>Ambient CO<sub>2</sub> concentration outside of boundary-layer. </td></tr>
<tr>
<td><img class="formulaInl" alt="$g_M$" src="form_63.png" width="21" height="11"/></td><td>mol air/m<sup>2</sup>-s</td><td>Conductance to moisture transfer between inside the leaf and leaf surface (i.e., stomatal conductance). </td></tr>
<tr>
<td><img class="formulaInl" alt="$g_H$" src="form_26.png" width="20" height="11"/></td><td>mol air/m<sup>2</sup>-s</td><td>Conductance to heat transfer between the leaf surface and outside the boundary-layer (i.e., boundary-layer conductance). </td></tr>
</table>
<h3><a class="anchor" id="FvCBPhotoParams"></a>
Summary of FvCB Model Parameters</h3>
<p>The table below gives example model coefficients obtained for several different species.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Species   </th><th class="markdownTableHeadNone"><img class="formulaInl" alt="$V_{cmax25}$" src="form_126.png" width="50" height="15"/>   </th><th class="markdownTableHeadNone"><img class="formulaInl" alt="$J_{max25}$" src="form_127.png" width="44" height="15"/>   </th><th class="markdownTableHeadNone"><img class="formulaInl" alt="$TPU_{25}$" src="form_128.png" width="47" height="15"/>   </th><th class="markdownTableHeadNone"><img class="formulaInl" alt="$R_{d25}$" src="form_129.png" width="29" height="15"/>   </th><th class="markdownTableHeadNone"><img class="formulaInl" alt="$\alpha$" src="form_107.png" width="9" height="8"/>   </th><th class="markdownTableHeadNone"><img class="formulaInl" alt="$\theta$" src="form_19.png" width="8" height="12"/>   </th><th class="markdownTableHeadNone"><img class="formulaInl" alt="$\Delta H_{a,Vcmax}$" src="form_130.png" width="74" height="17"/>   </th><th class="markdownTableHeadNone"><img class="formulaInl" alt="$T _{opt,Vcmax}$" src="form_131.png" width="69" height="15"/>   </th><th class="markdownTableHeadNone"><img class="formulaInl" alt="$\Delta H_{d,Vcmax}$" src="form_132.png" width="74" height="17"/>   </th><th class="markdownTableHeadNone"><img class="formulaInl" alt="$\Delta H_{a,Jmax}$" src="form_133.png" width="66" height="17"/>   </th><th class="markdownTableHeadNone"><img class="formulaInl" alt="$T _{opt,Jmax}$" src="form_134.png" width="62" height="15"/>   </th><th class="markdownTableHeadNone"><img class="formulaInl" alt="$\Delta H_{d,Jmax}$" src="form_135.png" width="66" height="17"/>   </th><th class="markdownTableHeadNone"><img class="formulaInl" alt="$\Delta H_{a,TPU}$" src="form_136.png" width="62" height="17"/>   </th><th class="markdownTableHeadNone"><img class="formulaInl" alt="$T _{opt,TPU}$" src="form_137.png" width="57" height="15"/>   </th><th class="markdownTableHeadNone"><img class="formulaInl" alt="$\Delta H_{d,TPU}$" src="form_138.png" width="62" height="17"/>    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Almond   </td><td class="markdownTableBodyNone">72.6   </td><td class="markdownTableBodyNone">144.2   </td><td class="markdownTableBodyNone">6.4   </td><td class="markdownTableBodyNone">0.2   </td><td class="markdownTableBodyNone">0.094   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">27.3   </td><td class="markdownTableBodyNone">315.3   </td><td class="markdownTableBodyNone">478.4   </td><td class="markdownTableBodyNone">64.1   </td><td class="markdownTableBodyNone">314.9   </td><td class="markdownTableBodyNone">508.4   </td><td class="markdownTableBodyNone">37.1   </td><td class="markdownTableBodyNone">311.3   </td><td class="markdownTableBodyNone">477.9    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">California Bay   </td><td class="markdownTableBodyNone">97.5   </td><td class="markdownTableBodyNone">193   </td><td class="markdownTableBodyNone">3.3   </td><td class="markdownTableBodyNone">0.1   </td><td class="markdownTableBodyNone">0.037   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">49.1   </td><td class="markdownTableBodyNone">308.6   </td><td class="markdownTableBodyNone">505.8   </td><td class="markdownTableBodyNone">34   </td><td class="markdownTableBodyNone">308.5   </td><td class="markdownTableBodyNone">456.7   </td><td class="markdownTableBodyNone">0.1   </td><td class="markdownTableBodyNone">309.4   </td><td class="markdownTableBodyNone">477.5    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Elderberry   </td><td class="markdownTableBodyNone">37.7   </td><td class="markdownTableBodyNone">149.7   </td><td class="markdownTableBodyNone">7.3   </td><td class="markdownTableBodyNone">1.3   </td><td class="markdownTableBodyNone">0.202   </td><td class="markdownTableBodyNone">0.472   </td><td class="markdownTableBodyNone">66   </td><td class="markdownTableBodyNone">319.4   </td><td class="markdownTableBodyNone">496   </td><td class="markdownTableBodyNone">24.5   </td><td class="markdownTableBodyNone">314.8   </td><td class="markdownTableBodyNone">492.9   </td><td class="markdownTableBodyNone">33.6   </td><td class="markdownTableBodyNone">314.5   </td><td class="markdownTableBodyNone">497.5    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Grape   </td><td class="markdownTableBodyNone">74.5   </td><td class="markdownTableBodyNone">180.2   </td><td class="markdownTableBodyNone">7.7   </td><td class="markdownTableBodyNone">1.3   </td><td class="markdownTableBodyNone">0.304   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">76.1   </td><td class="markdownTableBodyNone">318.8   </td><td class="markdownTableBodyNone">499.8   </td><td class="markdownTableBodyNone">23   </td><td class="markdownTableBodyNone">313.8   </td><td class="markdownTableBodyNone">502.3   </td><td class="markdownTableBodyNone">24   </td><td class="markdownTableBodyNone">314.6   </td><td class="markdownTableBodyNone">496.4    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Maple   </td><td class="markdownTableBodyNone">96.4   </td><td class="markdownTableBodyNone">168   </td><td class="markdownTableBodyNone">2.7   </td><td class="markdownTableBodyNone">0.1   </td><td class="markdownTableBodyNone">0.077   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">48.9   </td><td class="markdownTableBodyNone">307.1   </td><td class="markdownTableBodyNone">505   </td><td class="markdownTableBodyNone">8.5   </td><td class="markdownTableBodyNone">304.7   </td><td class="markdownTableBodyNone">476.7   </td><td class="markdownTableBodyNone">32.1   </td><td class="markdownTableBodyNone">308.3   </td><td class="markdownTableBodyNone">471.6    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Olive   </td><td class="markdownTableBodyNone">75.9   </td><td class="markdownTableBodyNone">170.4   </td><td class="markdownTableBodyNone">8.3   </td><td class="markdownTableBodyNone">1.9   </td><td class="markdownTableBodyNone">0.398   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">55.4   </td><td class="markdownTableBodyNone">315.2   </td><td class="markdownTableBodyNone">497   </td><td class="markdownTableBodyNone">32.2   </td><td class="markdownTableBodyNone">312.5   </td><td class="markdownTableBodyNone">493.4   </td><td class="markdownTableBodyNone">37.2   </td><td class="markdownTableBodyNone">311.7   </td><td class="markdownTableBodyNone">498.9    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pistachio   </td><td class="markdownTableBodyNone">101.8   </td><td class="markdownTableBodyNone">223   </td><td class="markdownTableBodyNone">9.8   </td><td class="markdownTableBodyNone">1.5   </td><td class="markdownTableBodyNone">0.216   </td><td class="markdownTableBodyNone">0.65   </td><td class="markdownTableBodyNone">56.5   </td><td class="markdownTableBodyNone">316.6   </td><td class="markdownTableBodyNone">483.1   </td><td class="markdownTableBodyNone">27.7   </td><td class="markdownTableBodyNone">314.6   </td><td class="markdownTableBodyNone">458.5   </td><td class="markdownTableBodyNone">39.9   </td><td class="markdownTableBodyNone">315.4   </td><td class="markdownTableBodyNone">494.3    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Toyon   </td><td class="markdownTableBodyNone">52.8   </td><td class="markdownTableBodyNone">142.4   </td><td class="markdownTableBodyNone">6.6   </td><td class="markdownTableBodyNone">0.8   </td><td class="markdownTableBodyNone">0.29   </td><td class="markdownTableBodyNone">0.532   </td><td class="markdownTableBodyNone">42.1   </td><td class="markdownTableBodyNone">315.1   </td><td class="markdownTableBodyNone">483   </td><td class="markdownTableBodyNone">9   </td><td class="markdownTableBodyNone">313   </td><td class="markdownTableBodyNone">486.2   </td><td class="markdownTableBodyNone">14   </td><td class="markdownTableBodyNone">314.8   </td><td class="markdownTableBodyNone">493.8    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Walnut   </td><td class="markdownTableBodyNone">81.6   </td><td class="markdownTableBodyNone">201.9   </td><td class="markdownTableBodyNone">10.2   </td><td class="markdownTableBodyNone">0.9   </td><td class="markdownTableBodyNone">0.362   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">85.3   </td><td class="markdownTableBodyNone">316.5   </td><td class="markdownTableBodyNone">500.6   </td><td class="markdownTableBodyNone">41.4   </td><td class="markdownTableBodyNone">308.6   </td><td class="markdownTableBodyNone">308.2   </td><td class="markdownTableBodyNone">21.9   </td><td class="markdownTableBodyNone">310.4   </td><td class="markdownTableBodyNone">434.9    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Redbud   </td><td class="markdownTableBodyNone">68.5   </td><td class="markdownTableBodyNone">132.4   </td><td class="markdownTableBodyNone">6.6   </td><td class="markdownTableBodyNone">0.8   </td><td class="markdownTableBodyNone">0.41   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">66.6   </td><td class="markdownTableBodyNone">315.1   </td><td class="markdownTableBodyNone">496   </td><td class="markdownTableBodyNone">41.2   </td><td class="markdownTableBodyNone">313.1   </td><td class="markdownTableBodyNone">474   </td><td class="markdownTableBodyNone">34.3   </td><td class="markdownTableBodyNone">312.8   </td><td class="markdownTableBodyNone">463.2    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Apple   </td><td class="markdownTableBodyNone">101.08   </td><td class="markdownTableBodyNone">167.03   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">3.00   </td><td class="markdownTableBodyNone">0.432   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">65.33   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">47.62   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Cherry   </td><td class="markdownTableBodyNone">75.65   </td><td class="markdownTableBodyNone">129.06   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">2.12   </td><td class="markdownTableBodyNone">0.404   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">65.33   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">48.49   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pear   </td><td class="markdownTableBodyNone">107.69   </td><td class="markdownTableBodyNone">176.71   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">1.51   </td><td class="markdownTableBodyNone">0.274   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">65.33   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">46.04   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Prune   </td><td class="markdownTableBodyNone">75.88   </td><td class="markdownTableBodyNone">129.41   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">1.65   </td><td class="markdownTableBodyNone">0.402   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">65.33   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">48.58   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td></tr>
</table>
<h3><a class="anchor" id="FvCBSettingPhotoParams"></a>
Setting FvCB Model Parameters</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_photosynthesis_model_8h.html">PhotosynthesisModel.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(){</div>
<div class="line">  <a class="code hl_class" href="class_photosynthesis_model.html">PhotosynthesisModel</a> photosynthesismodel(&amp;context);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Use the Farquahar-von Caemmerer-Berry model</span></div>
<div class="line">  photosynthesismodel.setModelType_Farquhar();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Use a species from the library</span></div>
<div class="line">  photosynthesis.setModelCoefficients(<span class="stringliteral">&quot;almond&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Or set parameters manually: fmc.setParam(k25, dHa, Topt(C), dHd)</span></div>
<div class="line">  <a class="code hl_struct" href="struct_farquhar_model_coefficients.html">FarquharModelCoefficients</a> fmc;</div>
<div class="line">  fmc.setVcmax(74.5, 76.1);               <span class="comment">// standard Arrhenius</span></div>
<div class="line">  fmc.setJmax(180.2, 23.0, 40.65, 502.3); <span class="comment">// peaked Arrhenius</span></div>
<div class="line">  fmc.setTPU(7.7, 24.0, 41.1, 496.4);</div>
<div class="line">  fmc.setRd(1.3);</div>
<div class="line">  fmc.setQuantumEfficiency_alpha(0.304);</div>
<div class="line">  fmc.setLightResponseCurvature_theta(0.601);</div>
<div class="line"> </div>
<div class="line">  photosynthesismodel.run();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Set model coefficients for different leaf groups</span></div>
<div class="line">  photosynthesis.setModelCoefficients(<span class="stringliteral">&quot;almond&quot;</span>, almondleaves);</div>
<div class="line">  photosynthesis.setModelCoefficients(<span class="stringliteral">&quot;grape&quot;</span>, grapeleaves);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Get and modify model coefficients</span></div>
<div class="line">  AlmondFarquharModelCoefficients afmc;</div>
<div class="line">  afmc = photosynthesis.getModelCoefficients(<span class="stringliteral">&quot;almond&quot;</span>);</div>
<div class="line">  afmc.setVcmax(1.5*fmc.getVcmaxTempResponse().value_at_25C, fmc.getVcmaxTempResponse().dHa);</div>
<div class="line">  photosynthesis.setModelCoefficients(afmc,almondleaves);</div>
<div class="line">}</div>
<div class="ttc" id="astruct_farquhar_model_coefficients_html"><div class="ttname"><a href="struct_farquhar_model_coefficients.html">FarquharModelCoefficients</a></div><div class="ttdef"><b>Definition</b> <a href="_photosynthesis_model_8h_source.html#l00112">PhotosynthesisModel.h:112</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="EmpiricalDescription"></a>
Empirical Model Description</h1>
<p>The net photosynthetic rate is described by the equation:</p>
<p><img class="formulaInl" alt="$A = A_{sat} f_L f_T f_C - R_d$" src="form_139.png" width="147" height="15"/></p>
<p><img class="formulaInl" alt="$A_{sat}\,({\mu}mol/m^2-s)$" src="form_140.png" width="129" height="18"/> is the photosynthesis assimilation rate at saturating irradiance and reference temperature ( <img class="formulaInl" alt="$T_{ref}$" src="form_141.png" width="29" height="15"/>) and intercellular CO<sub>2</sub> concentration ( <img class="formulaInl" alt="$C_{i,ref}$" src="form_142.png" width="36" height="17"/>).</p>
<h2><a class="anchor" id="LightResponse"></a>
Light Response Function</h2>
<p>The response of photosynthesis to light is given by a simple exponential function, which is defined by only one parameter:</p>
<p><img class="formulaInl" alt="$f_L(i) = \dfrac{i}{\theta+i}$" src="form_143.png" width="86" height="33"/>,</p>
<p>where <img class="formulaInl" alt="$\theta$" src="form_19.png" width="8" height="12"/> is the light response curvature.</p>
<h2><a class="anchor" id="TempResponse"></a>
Temperature Response</h2>
<p>It is assumed that the maximum CO<sub>2</sub> assimilation rate <img class="formulaInl" alt="$A_{max}$" src="form_144.png" width="36" height="15"/> decreases exponentially about some optimum temperature <img class="formulaInl" alt="$T_{opt}$" src="form_115.png" width="27" height="15"/>. The temperature response function is given by:</p>
<p><img class="formulaInl" alt="$f_T(T_s) = \left(\dfrac{T_s-T_{min}}{T_{ref}-T_{min}}\right)^q\left(\dfrac{(1+q)T_{opt}-T_{min}-qT_s}{(1+q)T_{opt}-T_{min}-qT_{ref}}\right)$" src="form_145.png" width="374" height="39"/>,</p>
<p>where <img class="formulaInl" alt="$T_{min}$" src="form_146.png" width="32" height="14"/> is the minimum temperature at which assimilation occurs, <img class="formulaInl" alt="$T_{opt}$" src="form_115.png" width="27" height="15"/> is the temperature at which the maximum assimilation rate occurs, <img class="formulaInl" alt="$T_{ref}$" src="form_141.png" width="29" height="15"/> is the reference temperature chosen to define <img class="formulaInl" alt="$A_{ref}$" src="form_147.png" width="32" height="17"/>, and <img class="formulaInl" alt="$q$" src="form_148.png" width="8" height="11"/> is a shape parameter.</p>
<p>The "dark" respiration rate <img class="formulaInl" alt="$R_d$" src="form_149.png" width="18" height="15"/> is assumed to increase exponentially with temperature following the Arrhenius equation (and assumed not to vary with ambient CO<sub>2</sub> concentration). Thus, the dark respiration rate is calculated simply as</p>
<p><img class="formulaInl" alt="$R_d = R\sqrt{T_s}\mathrm{exp}\left(-E_R/(T_s+273)\right)$" src="form_150.png" width="221" height="18"/>,</p>
<p>where <img class="formulaInl" alt="$R$" src="form_1.png" width="12" height="12"/> and <img class="formulaInl" alt="$E_R$" src="form_151.png" width="20" height="15"/> are parameters, and temperature is in Kelvin.</p>
<h2><a class="anchor" id="CO2Response"></a>
CO2 Response Function</h2>
<p>We assume that the maximum assimilation rate varies linearly with intercellular CO<sub>2</sub> concentration over the range of expected concentrations, and is zero at zero CO<sub>2</sub>. Thus, the response function is simply</p>
<p><img class="formulaInl" alt="$f_C(C_i) = k_C\dfrac{C_i}{C_{i,ref}}$" src="form_152.png" width="123" height="38"/>,</p>
<p>where <img class="formulaInl" alt="$C_i$" src="form_96.png" width="15" height="15"/> is intercellular CO<sub>2</sub> concentration ( <img class="formulaInl" alt="$\mu$" src="form_94.png" width="11" height="11"/>mol CO<sub>2</sub>/mol air).</p>
<h2><a class="anchor" id="Ci"></a>
Intercellular CO2 Concentration</h2>
<p>The intercellular CO<sub>2</sub> concentration is estimated as a function of the boundary-layer conductance, stomatal conductance, and ambient CO<sub>2</sub> concentration outside of the primitive boundary-layer. The rate of transport of CO<sub>2</sub> to the leaf (i.e., assimilation rate) is given by</p>
<p><img class="formulaInl" alt="$A = 0.75g_M\left(C_{amb}-C_i\right)$" src="form_153.png" width="161" height="17"/>,</p>
<p>where <img class="formulaInl" alt="$g_M$" src="form_63.png" width="21" height="11"/> is the conductance to moisture from the sub-stomatal cells to outside of the boundary-layer. The 0.75 factor comes from the fact that diffusion of CO<sub>2</sub> in air is slower than that of water vapor (see Eq. 7.33 of <a href="http://www.springer.com/us/book/9780387949376#otherversion=9781461216261">Campbell and Norman</a>).</p>
<p>Since <img class="formulaInl" alt="$A$" src="form_95.png" width="12" height="12"/> is dependent on <img class="formulaInl" alt="$C_i$" src="form_96.png" width="15" height="15"/> and vice-versa, an iterative solution is required for <img class="formulaInl" alt="$A$" src="form_95.png" width="12" height="12"/>.</p>
<h2><a class="anchor" id="PhotoCalib"></a>
Empirical Model Calibration Procedure</h2>
<h3><a class="anchor" id="PhotoVars"></a>
Summary of Empirical Model Independent Variables</h3>
<table class="doxtable">
<tr>
<th>Variable</th><th>Units</th><th>Description </th></tr>
<tr>
<td><img class="formulaInl" alt="$i$" src="form_154.png" width="6" height="11"/></td><td>W/m<sup>2</sup></td><td>Photosynthetic radiation energy flux. </td></tr>
<tr>
<td><img class="formulaInl" alt="$T_s$" src="form_61.png" width="15" height="14"/></td><td>Kelvin</td><td>Surface temperature. </td></tr>
<tr>
<td><img class="formulaInl" alt="$C_{amb}$" src="form_155.png" width="33" height="15"/></td><td><img class="formulaInl" alt="$\mu$" src="form_94.png" width="11" height="11"/>mol CO<sub>2</sub>/mol air</td><td>Ambient CO<sub>2</sub> concentration outside of boundary-layer. </td></tr>
<tr>
<td><img class="formulaInl" alt="$g_{bl}$" src="form_156.png" width="17" height="11"/></td><td>mol air/m<sup>2</sup>-s</td><td>Boundary-layer conductance. </td></tr>
<tr>
<td><img class="formulaInl" alt="$g_s$" src="form_157.png" width="14" height="11"/></td><td>mol air/m<sup>2</sup>-s</td><td>Stomatal conductance. </td></tr>
</table>
<h3><a class="anchor" id="PhotoParams"></a>
Summary of Empirical Model Parameters</h3>
<table class="doxtable">
<tr>
<th>Parameter</th><th>Units</th><th>Description </th></tr>
<tr>
<td><img class="formulaInl" alt="$A_{sat}$" src="form_158.png" width="29" height="15"/></td><td>mol CO<sub>2</sub>/m<sup>2</sup>-sec</td><td>Assimilation rate at saturating irradiance and reference temperature and intercellular CO<sub>2</sub> concentration. </td></tr>
<tr>
<td><img class="formulaInl" alt="$\theta$" src="form_19.png" width="8" height="12"/></td><td>W/m<sup>2</sup></td><td>Shape parameter for response to light. </td></tr>
<tr>
<td><img class="formulaInl" alt="$T_{min}$" src="form_146.png" width="32" height="14"/></td><td>Kelvin</td><td>Minimum temperature at which assimilation occurs. </td></tr>
<tr>
<td><img class="formulaInl" alt="$T_{opt}$" src="form_115.png" width="27" height="15"/></td><td>Kelvin</td><td>Temperature at which maximum assimilation rate occurs. </td></tr>
<tr>
<td><img class="formulaInl" alt="$q$" src="form_148.png" width="8" height="11"/></td><td>unitless</td><td>Temperature response shape function. </td></tr>
<tr>
<td><img class="formulaInl" alt="$R$" src="form_1.png" width="12" height="12"/></td><td><img class="formulaInl" alt="${\mu}$" src="form_159.png" width="11" height="11"/>mol K<sup>1/2</sup>/m<sup>2</sup>-s</td><td>Pre-exponential factor for respiration temperature response. </td></tr>
<tr>
<td><img class="formulaInl" alt="$E_R$" src="form_151.png" width="20" height="15"/></td><td>1/Kelvin</td><td>Respiration temperature response rate. </td></tr>
<tr>
<td><img class="formulaInl" alt="$k_C$" src="form_160.png" width="17" height="15"/></td><td>unitless</td><td>CO<sub>2</sub> response rate. </td></tr>
</table>
<h3><a class="anchor" id="PhotoLightParam"></a>
Response of Assimilation Rate to Light</h3>
<p>The response of the assimilation rate to light is obtained from gas exchange measurements at reference temperature ( <img class="formulaInl" alt="$T_{ref}$" src="form_141.png" width="29" height="15"/>) and CO<sub>2</sub> ( <img class="formulaInl" alt="$C_{i,ref}$" src="form_142.png" width="36" height="17"/>) in which the irradiance is varied across some range. However, one important detail is that the dark respiration rate should be removed such that <img class="formulaInl" alt="$A=0$" src="form_161.png" width="41" height="12"/> in the dark (see plot below). This can be done by measuring the net CO<sub>2</sub> flux starting in the dark, then subtracting the dark flux from the total flux for each subsequent light level.</p>
<div class="image">
<img src="LightResponse.png" alt=""/>
</div>
<h3><a class="anchor" id="PhotoTempParam"></a>
Response of Assimilation Rate to Temperature</h3>
<p>The response of the assimilation rate to temperature is obtained using gas exchange measurements at saturating light levels and the reference CO<sub>2</sub> concentration. The temperature is varied across some range, and the assimilation rate is measured. It is assumed that the optimum temperature <img class="formulaInl" alt="$T_{opt}$" src="form_115.png" width="27" height="15"/> is the temperature corresponding to the maximum measured assimilation rate. The model is fit to the data to determine <img class="formulaInl" alt="$T_{min}$" src="form_146.png" width="32" height="14"/> and <img class="formulaInl" alt="$q$" src="form_148.png" width="8" height="11"/>.</p>
<div class="image">
<img src="TempResponse.png" alt=""/>
</div>
<h3><a class="anchor" id="PhotoRespParam"></a>
Response of Respiration Rate to Temperature</h3>
<p>The response of the dark respiration to temperature is obtained using gas exchange measurements in the dark. The leaf is first acclimated to the dark chamber, then leaf temperature is varied across some range. The model is then fit to the data to determine parameters.</p>
<div class="image">
<img src="RespResponse.png" alt=""/>
</div>
<h3><a class="anchor" id="PhotoCO2Param"></a>
Response of Assimilation Rate to CO2</h3>
<p>The response of the assimilation rate is obtained using gas exchange measurements at saturating light levels and the reference temperature <img class="formulaInl" alt="$T_{ref}$" src="form_141.png" width="29" height="15"/>, but with varying external CO<sub>2</sub> concentration (which produces varying intercellular CO<sub>2</sub>).</p>
<div class="image">
<img src="CO2Response.png" alt=""/>
</div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
