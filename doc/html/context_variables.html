<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tutorial 5: Context Variables</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Helios_logo_small.png"/></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Tutorial 5: Context Variables </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="context_variables_intro"></a>
Introduction to Variables</h1>
<p>A model's job is often to compute one or more values associated with each primitive. For example, the energy balance model is tasked with computing the surface temperature of every primitive in the simulated domain. This temperature value is a real number that in general is different for each primitive.</p>
<p>In Helios, this data is represented by "variables", which are floating-point values defined for every primitive in the context. These are often used to store field variables (e.g., temperature, fluxes, etc.), and are the means by which models communicate with each other. In the graphical depiction of the Context given below, two variables have been added to the Context which are denoted by the yellow boxes. One is called "radiation_flux" and the other "temperature". Note that each primitive (i.e., a triangle and two patches) has different values for each of these two variables.</p>
<div class="image">
<img src="Context_sketch.png" alt="Context_sketch.png"/>
</div>
<h1><a class="anchor" id="context_variables_add"></a>
Adding Variables to the Context</h1>
<p>Variables are added to the Context via the addVariable() function, which is a member function of the Context. The argument to this function is a string corresponding to a label for the variable, which is chosen by the user. The example below shows how to add a variable called "my_variable" to the Context.</p>
<div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"> <pre><code> #include "Context.h"</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code> using namespace helios; //note that we are using the helios namespace so we can omit 'helios::' before names</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code> int main(void){</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    Context context;  //Declare the "Context" class</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    vec3 position(0,0,0); //(x,y,z) position of patch center
    vec2 size(1,1); //length and width of patch</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    uint UUID; //declare the UUID variable</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    UUID = context.addPatch( position, size ); //this will assign the UUID for this patch to the UUID variable</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    context.addVariable("my_variable"); //add our variable to the context</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>}</code></pre></div><h1><a class="anchor" id="context_variables_setget"></a>
Setting and Getting Variable Values</h1>
<p>By default, the value of "my_variable" for the patch is initialized to 0. We can set the value of "my_variable" manually using the setVariableValue() function in the Context if we have the UUID for that primitive. Often, models will call this function to set the value of variables based on model calculations.</p>
<p>We can also query the values of variables for primitives. In the example below, we'll add two primitives to the Context, then set the values of the variable "my_variable". Then, we'll query the values of the variable for the two primitives.</p>
<div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"> <pre><code> #include "Context.h"</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code> using namespace helios; //note that we are using the helios namespace so we can omit 'helios::' before names</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code> int main(void){</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    Context context;  //Declare the "Context" class</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    vec3 position(0,0,0); //(x,y,z) position of patch center
    vec2 size(1,1); //length and width of patch</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    uint UUID0 = context.addPatch( position, size ); //this will assign the UUID for this patch to the UUID variable</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    position.x += 2; //modify the x-position that we'll use for the next patch
    uint UUID1 = context.addPatch( position, size ); //this will assign the UUID for this patch to the UUID variable</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    context.addVariable("my_variable"); //add our variable to the context</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    context.setVariableValue(UUID0,"my_variable",10.0); //set the value of my_variable to 10 for the first patch</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    context.setVariableValue(UUID1,"my_variable",20.0); //set the value of my_variable to 20 for the second patch</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    float v0 = context.getVariableValue(UUID0,"my_variable"); //get the value of my_variable for the first patch
    std::cout &lt;&lt; "The value of 'my_variable' for the first patch is " &lt;&lt; v0 &lt;&lt; std::endl;</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    float v1 = context.getVariableValue(UUID1,"my_variable"); //get the value of my_variable for the second patch
    std::cout &lt;&lt; "The value of 'my_variable' for the second patch is " &lt;&lt; v1 &lt;&lt; std::endl;</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>}</code></pre></div><p>Often, you may want to set a variable for many primitives to the same value. Similarly, you may also want to get the variable value for many primitives at once. This could be done using the method illustrated above within a loop, or there are other versions of the functions setVariableValue() and getVariableValue() that can be passed or return vectors. This is illustrated in the example below.</p>
<div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"> <pre><code> #include "Context.h"</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code> using namespace helios; //note that we are using the helios namespace so we can omit 'helios::' before names</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code> int main(void){</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    Context context;  //Declare the "Context" class</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    vec3 center(0,0,0); //(x,y,z) position of sphere center
    float r = 1; //radius of sphere</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    std::vector&lt;uint&gt; UUIDs; //vector to store UUIDs of sphere</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    UUIDs = context.addSphere( 10, center, r ); //add a sphere to the Context</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    context.addVariable("my_variable"); //add our variable to the context</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    context.setVariableValue(UUIDs,"my_variable",10.0); //set the value of my_variable to 10 for all primitives comprising the sphere</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    std::vector&lt;float&gt; v;
    v = context.getVariableValue(UUIDs,"my_variable"); //get the variable value for all primitives and store the values in vector 'v'</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>    <code></code>//v will now be a vector of 10's</code></pre></div><div style="padding:0.5px;background-color:#D0D0D0 ;line-height:1.2;"><pre><code>}</code></pre></div> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
